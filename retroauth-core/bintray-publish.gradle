apply plugin: 'maven'

group = 'com.andretietz.retroauth'
version = '2.0.0-SNAPSHOT'

configurations {
    archives {
        extendsFrom configurations.default
    }
}

/**
 * pack sources jar
 */
task sourcesJar(type: Jar) {
    classifier = 'sources'
    from sourceSets.main.java.srcDirs
}

/**
 * add sources.jar to artifacts
 */
artifacts {
    archives sourcesJar
}

/*
uploadArchives {
    configuration = configurations.archives
    repositories {
        mavenDeployer {
            repository(url: "http://52.19.153.63:8081/nexus/content/repositories/moovel-android") {
                authentication(userName: ldapUsername, password: ldapPassword)
            }

            pom.project {
                name 'Moovel Authentication Library'
                packaging 'aar'
                description 'App authentication for Moovel apps'
                url 'https://github.com/moovel/android-authentication_manager'

                scm {
                    url 'scm:git@lab.mytaxi.com:gitlab.ims/authentication-manager-android.git'
                    connection 'scm:git@lab.mytaxi.com:gitlab.ims/authentication-manager-android.git'
                    developerConnection 'scm:git@lab.mytaxi.com:gitlab.ims/authentication-manager-android.git'
                }
            }
        }
    }
} */

/**
 * upload aar and artifacts to local repository
 */
task installArchives(type: Upload) {
    description "Installs the artifacts to the local Maven repository."
    configuration = configurations['archives']
    repositories {
        mavenDeployer {
            repository(url: 'file://' + new File(System.getProperty('user.home'), '.m2/repository').absolutePath)

            pom.project {
                name 'Retroauth Library'
                packaging 'jar'
                description 'Authentication library for retrofit 2'
                url 'https://github.com/andretietz/retroauth'

                scm {
                    url 'scm:git@github.com:andretietz/retroauth.git'
                    connection 'scm:git@github.com:andretietz/retroauth.git'
                    developerConnection 'scm:git@github.com:andretietz/retroauth.git'
                }
            }
        }
    }
}